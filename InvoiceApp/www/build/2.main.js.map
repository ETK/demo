{"version":3,"sources":["../../src/pages/work/transfer-list/transfer-list.module.ts","../../src/pages/work/transfer-list/transfer-list.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACG;AAanD,IAAa,sBAAsB;IAAnC;IAAqC,CAAC;IAAD,6BAAC;AAAD,CAAC;AAAzB,sBAAsB;IAXlC,sFAAQ,CAAC;QACN,YAAY,EAAE;YACV,wEAAgB;SACnB;QACD,OAAO,EAAE;YACL,sEAAe,CAAC,QAAQ,CAAC,wEAAgB,CAAC;SAC7C;QACD,OAAO,EAAE;YACL,wEAAgB;SACnB;KACJ,CAAC;GACW,sBAAsB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;ACfO;AAC0C;AACxB;AACE;AACF;AAE5D;;;;EAIE;AAMF,IAAa,gBAAgB;IAM3B,0BACS,OAAsB,EACtB,SAAoB,EACpB,SAA0B,EAC1B,OAAmB,EACnB,IAAiB,EACjB,UAAqB;QALrB,YAAO,GAAP,OAAO,CAAe;QACtB,cAAS,GAAT,SAAS,CAAW;QACpB,cAAS,GAAT,SAAS,CAAiB;QAC1B,YAAO,GAAP,OAAO,CAAY;QACnB,SAAI,GAAJ,IAAI,CAAa;QACjB,eAAU,GAAV,UAAU,CAAW;QAV9B,UAAK,GAAU,EAAE,CAAC;QAClB,cAAS,GAAW,EAAE,CAAC;IAUnB,CAAC;IAEL,yCAAc,GAAd;QACE,IAAI,CAAC,OAAO,EAAE,CAAC;IACjB,CAAC;IAED,kCAAO,GAAP,UAAQ,QAAyB;QAAjC,iBAeC;QAfO,2CAAyB;QAC/B,IAAI,GAAG,GAAG,oaAMU,CAAC;QACrB,EAAE,CAAC,CAAC,QAAQ,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;YAC/B,GAAG,IAAI,qIAAqI,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;QAC9K,CAAC;QACD,GAAG,IAAI,sBAAsB,CAAC;QAC9B,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,cAAI;YACtC,KAAI,CAAC,KAAK,GAAG,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;IACL,CAAC;IAED,mCAAQ,GAAR,UAAS,MAAM;QAAf,iBAQC;QAPC,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC;QAClC,UAAU,CAAC;YACT,EAAE,CAAC,CAAC,MAAM,CAAC,SAAS,IAAI,KAAI,CAAC,SAAS,CAAC,CAAC,CAAC;gBACvC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAC1B,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YACrB,CAAC;QACH,CAAC,EAAE,GAAG,CAAC,CAAC;IACV,CAAC;IAED,kCAAO,GAAP,UAAQ,GAAQ;QACd,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC,CAAC;IAC3E,CAAC;IAED,qCAAU,GAAV,UAAW,GAAQ;QAAnB,iBAMC;QALC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,EAAE,EAAE;YACjC,KAAI,CAAC,OAAO,CAAC,UAAU,CAAC,aAAa,EAAE,iBAAiB,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,cAAI;gBAC9E,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;YAChD,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IACD,gCAAK,GAAL,UAAM,GAAQ;QAAd,iBAUC;QATC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,EAAE,EAAE;YACjC,KAAI,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,IAAI,CAAC,cAAI;gBACnD,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,IAAI,GAAG,CAAC,CAAC,CAAC;oBACvB,KAAI,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;oBACrC,MAAM,CAAC;gBACT,CAAC;gBACD,KAAI,CAAC,OAAO,EAAE,CAAC;YACjB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IACH,uBAAC;AAAD,CAAC;AApEY,gBAAgB;IAL5B,uFAAS,EAAE;IACX,wFAAS,CAAC;QACT,QAAQ,EAAE,oBAAoB;OACG;KAClC,CAAC;yEAQ+B;QACX,sEAAS;QACT,2EAAe;QACjB,4EAAU;QACb,2EAAW;QACN,UAAU;AAwD/B;SApEY,gBAAgB,gB","file":"2.main.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { TransferListPage } from './transfer-list';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        TransferListPage,\r\n    ],\r\n    imports: [\r\n        IonicPageModule.forChild(TransferListPage),\r\n    ],\r\n    exports: [\r\n        TransferListPage\r\n    ]\r\n})\r\nexport class TransferListPageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/work/transfer-list/transfer-list.module.ts","import { Component } from '@angular/core';\r\nimport {IonicPage, NavController, NavParams, ModalController } from 'ionic-angular';\r\nimport { SqlService } from '../../../providers/sql-service';\r\nimport { UtilService } from '../../../providers/util-service';\r\nimport { StkService } from '../../../providers/stk-service';\r\n\r\n/*\r\n  调拨单.\r\n wudefeng\r\n 2017-5-11\r\n*/\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-transfer-list',\r\n  templateUrl: 'transfer-list.html'\r\n})\r\nexport class TransferListPage {\r\n\r\n  items: any[] = [];\r\n  searchKey: string = \"\";\r\n  inputTime: any;\r\n\r\n  constructor(\r\n    public navCtrl: NavController,\r\n    public navParams: NavParams,\r\n    public modalCtrl: ModalController,\r\n    public sqlHelp: SqlService,\r\n    public util: UtilService,\r\n    public stkService:StkService\r\n  ) { }\r\n\r\n  ionViewDidLoad() {\r\n    this.getData();\r\n  }\r\n\r\n  getData(isFilter: boolean = false) {\r\n    let sql = `select a.*,count(b.id) as itemCount,sum(b.qty*e.cost_price) as cost,\r\n                c.depot_name as out_store_name,d.depot_name as in_store_name \r\n             from bl_transfer a join bl_transfer_dtl b on a.bill_no=b.bill_no \r\n             join depot c on a.out_store_no = c.depot_no\r\n             join depot d on a.in_store_no = d.depot_no\r\n             join good e on b.good_no = e.good_no\r\n             where 1=1 `;\r\n    if (isFilter && this.searchKey) {\r\n      sql += \" and (a.bill_no like '%?%' or b.good_no like '%?%' or c.depot_name like '%?%' or d.depot_name like '%?%' or e.good_name like '%?%')\".replace(/\\?/g, this.searchKey);\r\n    }\r\n    sql += \"  group by a.bill_no\";\r\n    this.sqlHelp.getRowsBySql(sql).then(data => {\r\n      this.items = [].concat(data);\r\n    });\r\n  }\r\n\r\n  onSearch($event) {\r\n    this.inputTime = $event.timeStamp;\r\n    setTimeout(() => {\r\n      if ($event.timeStamp == this.inputTime) {\r\n        console.info(\"search...\");\r\n        this.getData(true);\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  addItem(obj: any) {\r\n    this.navCtrl.push('TransferDetailPage', { item: obj, parentPage: this });\r\n  }\r\n\r\n  deleteItem(obj: any) {\r\n    this.util.showConfirm(\"确认删除？\", \"\", () => {\r\n      this.sqlHelp.removeBill(\"bl_transfer\", \"bl_transfer_dtl\", obj.bill_no).then(data => {\r\n        this.items.splice(this.items.indexOf(obj), 1);\r\n      });\r\n    });\r\n  }\r\n  audit(obj: any) {\r\n    this.util.showConfirm(\"确认审核？\", \"\", () => {\r\n      this.stkService.stkBiz(obj.bill_no, \"1006\").then(data => {\r\n        if (data.result == \"1\") {\r\n          this.util.showAlert(data.msg, \"出错了\");\r\n          return;\r\n        }\r\n        this.getData();\r\n      });\r\n    });\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/work/transfer-list/transfer-list.ts"],"sourceRoot":""}