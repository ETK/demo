{"version":3,"sources":["../../src/pages/work/goods-edit/goods-edit.module.ts","../../src/pages/work/goods-edit/goods-edit.ts"],"names":[],"mappings":"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","file":"18.main.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { GoodsEditPage } from './goods-edit';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        GoodsEditPage,\r\n    ],\r\n    imports: [\r\n        IonicPageModule.forChild(GoodsEditPage),\r\n    ],\r\n    exports: [\r\n        GoodsEditPage\r\n    ]\r\n})\r\nexport class GoodsEditPageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/work/goods-edit/goods-edit.module.ts","import {Component} from '@angular/core';\r\nimport {IonicPage,NavController, NavParams} from 'ionic-angular';\r\nimport {UtilService} from '../../../providers/util-service';\r\nimport {ImagePicker} from '@ionic-native/image-picker';\r\nimport {Camera, CameraOptions} from '@ionic-native/camera';\r\nimport {SqlService} from \"../../../providers/sql-service\";\r\n\r\n\r\n/*\r\n Generated class for the GoodsEdit page.\r\n\r\n See http://ionicframework.com/docs/v2/components/#navigation for more info on\r\n Ionic pages and navigation.\r\n */\r\n@IonicPage()\r\n@Component({\r\n    selector: 'page-goods-edit',\r\n    templateUrl: 'goods-edit.html'\r\n})\r\nexport class GoodsEditPage {\r\n    obj: any;\r\n    item: any;\r\n    flag: number;\r\n    titleText: string;\r\n    isCreatorShow:boolean;\r\n    isDoodNoDisabled:boolean;\r\n\r\n    constructor(public navCtrl: NavController,\r\n                public navParams: NavParams,\r\n                private util: UtilService,\r\n                private imagePicker: ImagePicker,\r\n                private camera: Camera,\r\n                private sqlService: SqlService) {\r\n        this.item = this.navParams.get('item');\r\n        if (this.item) {\r\n            //编辑\r\n            this.flag = 1;\r\n            this.titleText = '编辑';\r\n            this.isCreatorShow=false;\r\n            this.isDoodNoDisabled=true;\r\n            this.obj = this.item;\r\n        } else {\r\n            //添加\r\n            this.obj = {};\r\n            this.titleText = '添加';\r\n            this.isCreatorShow=true;\r\n            this.isDoodNoDisabled=false;\r\n            this.flag = 2;\r\n        }\r\n    }\r\n\r\n    modifyPic() {\r\n        this.util.showActionSheet('拍照', '相册', () => {\r\n            this.cameraFun();\r\n        }, () => {\r\n            this.imagePickerFun();\r\n        });\r\n    }\r\n\r\n    cameraFun() {\r\n        const options: CameraOptions = {\r\n            quality: 100,\r\n            destinationType: this.camera.DestinationType.FILE_URI,\r\n            encodingType: this.camera.EncodingType.JPEG,\r\n            mediaType: this.camera.MediaType.PICTURE\r\n        };\r\n\r\n        this.camera.getPicture(options).then((imageData) => {\r\n            this.util.refreshUI(() => {\r\n                this.obj.img = imageData;\r\n            });\r\n        }, (err) => {\r\n            // Handle error\r\n            this.util.showToast(err);\r\n        });\r\n\r\n    }\r\n\r\n    imagePickerFun() {\r\n        let imagePickerOpt = {\r\n            maximumImagesCount: 1,//选择一张图片\r\n            width: 200,\r\n            height: 200,\r\n            quality: 100\r\n        };\r\n        this.imagePicker.getPictures(imagePickerOpt).then((results) => {\r\n            for (var i = 0; i < results.length; i++) {\r\n                this.obj.img = results[i];\r\n            }\r\n        }, (err) => {\r\n            this.util.showToast(err);\r\n        });\r\n\r\n    }\r\n\r\n    save() {\r\n        if (!this.obj.good_no || !this.obj.good_name || !this.obj.purchase_price || !this.obj.sale_price || !this.obj.mini_safe_num || !this.obj.max_safe_num) {\r\n            this.util.showToast(\"请注意查看必填信息\");\r\n            return;\r\n        }\r\n        if (!this.obj.cost_price) {\r\n            //当没有输入成本价时，成本价等于进价\r\n            this.obj.cost_price = this.obj.purchase_price;\r\n\r\n        } else {\r\n            //成本价必须大于进价\r\n            if (this.obj.cost_price <= this.obj.purchase_price) {\r\n                this.util.showToast(\"成本价必须大于采购价\");\r\n                return;\r\n            }\r\n        }\r\n        //销售价必须大于成本价\r\n        if (this.obj.sale_price && this.obj.sale_price <= this.obj.cost_price) {\r\n            this.util.showToast(\"销售价必须大于成本价\");\r\n            return;\r\n        }\r\n        //销售价必须大于采购价\r\n        if (this.obj.sale_price && this.obj.sale_price <= this.obj.purchase_price) {\r\n            this.util.showToast(\"销售价必须大于采购价\");\r\n            return;\r\n        }\r\n        //最高安全库存必须大于最低安全库存\r\n        if (this.obj.max_safe_num <= this.obj.mini_safe_num) {\r\n            this.util.showToast(\"最高安全库存必须大于最低安全库存\");\r\n            return;\r\n        }\r\n\r\n        this.addToSqlite();\r\n\r\n    }\r\n\r\n    addToSqlite(){\r\n        this.util.getByKey('userName').then((result) => {\r\n            this.obj.creator = result;\r\n            this.obj.create_time=this.util.getNowFormatDate();\r\n            this.sqlService.save('good', this.obj).then(() => {\r\n                this.navCtrl.pop();\r\n            }).catch((err) => {\r\n                console.error(err);\r\n            });\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/work/goods-edit/goods-edit.ts"],"sourceRoot":""}