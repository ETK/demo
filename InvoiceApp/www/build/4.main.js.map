{"version":3,"sources":["../../src/pages/work/transfer-detail/transfer-goods.module.ts","../../src/pages/work/transfer-detail/transfer-goods.ts"],"names":[],"mappings":"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","file":"4.main.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { TransferGoodsPage} from './transfer-goods';\r\n\r\n@NgModule({\r\n    declarations: [       \r\n        TransferGoodsPage\r\n    ],\r\n    imports: [\r\n        IonicPageModule.forChild(TransferGoodsPage)\r\n    ],\r\n    exports: [     \r\n        TransferGoodsPage\r\n    ]\r\n})\r\nexport class TransferGoodsPageModule { }\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/work/transfer-detail/transfer-goods.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage,NavController, NavParams, ViewController } from 'ionic-angular';\r\nimport { SqlService } from '../../../providers/sql-service';\r\nimport { UtilService } from '../../../providers/util-service';\r\n\r\n\r\n@IonicPage()\r\n@Component({\r\n  template: `\r\n   <ion-header>\r\n\r\n  <ion-navbar>\r\n    <ion-title>选择商品</ion-title>    \r\n  </ion-navbar>\r\n\r\n</ion-header>\r\n\r\n<ion-content>\r\n  <ion-searchbar placeholder=\"输入商品编，名称查询\" (ionInput)=\"search($event)\"></ion-searchbar>\r\n  <ion-list>\r\n    <ion-item *ngFor=\"let item of items\">\r\n      <ion-thumbnail item-left>\r\n        <img [src]=\"item.img\">\r\n      </ion-thumbnail>\r\n      <h3>产品编号：{{item.good_no}}</h3>\r\n      <h3>产品名称：{{item.good_name}}</h3>\r\n      <h3>当前库存：{{item.qty}}</h3>\r\n\r\n       <div item-right style=\"margin-right: -6px\">\r\n              <button ion-button (click)=\"changeQty(item,-1)\" style=\"margin-right:-6px\" clear icon-only >\r\n               <ion-icon name=\"remove\"></ion-icon>\r\n           </button>\r\n              <button ion-button (click)=\"inputQty(item)\" style=\"min-width:35px\" outline>\r\n              {{item.input_qty}}\r\n            </button>\r\n              <button ion-button (click)=\"changeQty(item,1)\" style=\"margin-left:-6px\" bold clear icon-only >\r\n               <ion-icon name=\"add\"></ion-icon>\r\n            </button>\r\n            </div>\r\n\r\n    </ion-item>\r\n  </ion-list>  \r\n</ion-content>\r\n<ion-footer>\r\n  <ion-item color=\"light\">\r\n     已选择:{{getCount()}}项\r\n     <button ion-button  item-right (click)=\"confirmChoose()\">确认</button>\r\n  </ion-item>\r\n</ion-footer>   \r\n  `\r\n})\r\nexport class TransferGoodsPage {\r\n  parentPage: any;\r\n\r\n  items: any[] = [];\r\n\r\n  constructor(\r\n    private navCtrl:NavController,\r\n    private navParams: NavParams,\r\n    private viewCtrl: ViewController,\r\n    private sqlHelp: SqlService,\r\n    private util :UtilService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    if (this.navParams.get(\"parentPage\")) {\r\n      this.parentPage = this.navParams.data.parentPage;\r\n      this.getData();\r\n    }\r\n  }\r\n\r\n  getData(value:string=\"\") {\r\n    let sql = 'select a.*,b.qty from good a join stk b on a.good_no=b.good_no where b.store_no=?';\r\n    let param = [this.parentPage.item.out_store_no];\r\n    if (value) {\r\n      sql += \" and (a.good_no like '%?%' or a.good_name like '%?%')\".replace(/\\?/g, value);\r\n    }\r\n    this.sqlHelp.getRowsBySql(sql, param).then(rows => {\r\n      this.items = [].concat(rows);\r\n      let item;\r\n      for (let obj of this.parentPage.goodsList) {\r\n        item = this.items.find(i => { return i.good_no == obj.good_no });\r\n        if (item) {\r\n          item.input_qty = obj.qty;\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  search(ev) {\r\n    let val = ev.target.value;\r\n    this.getData(val);\r\n  }\r\n\r\n  confirmChoose() {\r\n    let inputArr: any[] = []\r\n    for (let item of this.items) {\r\n      if (item.input_qty) {\r\n        inputArr.push({\r\n          bill_no: this.parentPage.item.bill_no,\r\n          good_no: item.good_no,\r\n          qty: item.input_qty,\r\n          cost_price: item.cost_price\r\n        });\r\n      }\r\n    }\r\n    this.parentPage.goodsList = [].concat(inputArr);\r\n    this.navCtrl.pop();\r\n  }\r\n\r\n  inputQty(obj: any) {\r\n    \r\n    this.util.showPrompt('', '输入调拨数量', [{ name: 'qty', placeholder: '请输入调拨数量', type: 'number', value: obj.input_qty||'' }], data => {\r\n\r\n      if (data.qty == \"\") {\r\n        this.util.showAlert(\"请输入数量\");\r\n        return false;\r\n      }\r\n      if (Number(data.qty) > 0) {\r\n        obj.input_qty = data.qty;\r\n      }\r\n    });\r\n  }\r\n\r\n  changeQty(item, dir) {\r\n    let qty = (Number(item.input_qty) || 0) + dir;\r\n    if (qty >= 0) { item.input_qty = qty; }   \r\n  }\r\n  \r\n  getCount() {\r\n    let count = 0;\r\n    for (let item of this.items) {\r\n      if (item.input_qty) {\r\n        count++\r\n      }\r\n    }\r\n    return count;\r\n  }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/work/transfer-detail/transfer-goods.ts"],"sourceRoot":""}